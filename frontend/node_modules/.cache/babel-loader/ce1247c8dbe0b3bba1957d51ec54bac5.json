{"ast":null,"code":"import _objectSpread from \"/home/miles/webdev/jes-sched/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/miles/webdev/jes-sched/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/miles/webdev/jes-sched/frontend/src/components/Schedule.js\";\nimport React, { useState, useEffect } from \"react\";\nimport CustomDnDCalendar from \"./CustomDnDCalendar\";\nimport EventForm from \"./EventForm\";\nimport TeacherForm from \"./TeacherForm\";\nimport useFormState from \"../hooks/useInputState\";\nimport { validateRoom, validateTeacher } from \"../validators\";\nimport { addTeachingMins, getTeachers, getLessons, addLesson, addTeacher, updateTeacher, changeEvent } from \"../helperFunctions\";\nimport \"react-big-calendar/lib/sass/styles.scss\";\nimport \"react-big-calendar/lib/addons/dragAndDrop/styles.scss\";\n\nconst Schedule = () => {\n  const _useState = useState(\"\"),\n        _useState2 = _slicedToArray(_useState, 2),\n        formType = _useState2[0],\n        setFormType = _useState2[1];\n\n  const _useState3 = useState([{\n    id: 1,\n    title: \"Dummy Event to fix drag and drop bug\",\n    start: new Date(),\n    end: new Date(),\n    room: 2,\n    duration: 0,\n    resourceId: 1,\n    hide: true\n  }]),\n        _useState4 = _slicedToArray(_useState3, 2),\n        events = _useState4[0],\n        setEvents = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        teachers = _useState6[0],\n        setTeachers = _useState6[1];\n\n  const _useFormState = useFormState(new Date()),\n        _useFormState2 = _slicedToArray(_useFormState, 3),\n        startTime = _useFormState2[0],\n        updateStartTime = _useFormState2[1],\n        startTimeReset = _useFormState2[2];\n\n  const _useState7 = useState(\"\"),\n        _useState8 = _slicedToArray(_useState7, 2),\n        selectedEvent = _useState8[0],\n        setSelectedEvent = _useState8[1];\n\n  useEffect(() => {\n    getLessons(events, setEvents);\n    getTeachers(setTeachers);\n  }, []);\n  useEffect(() => {\n    addTeachingMins(events, teachers, setTeachers);\n  }, [events]);\n\n  const moveEvent = ({\n    event,\n    resourceId,\n    start,\n    end\n  }) => {\n    const idx = events.indexOf(event);\n\n    const updatedEvent = _objectSpread({}, event, {\n      resourceId,\n      start,\n      end\n    });\n\n    const nextEvents = [...events];\n    nextEvents.splice(idx, 1, updatedEvent);\n    setEvents(nextEvents); // alert(`${event.title} was dropped onto ${updatedEvent.start}`)\n  };\n\n  const handleMove = ({\n    event,\n    resourceId,\n    start,\n    end\n  }) => {\n    const idx = events.indexOf(event);\n    const otherEvents = [...events.slice(0, idx), ...events.slice(idx + 1)];\n\n    if (!validateRoom(otherEvents, event.room, start, parseInt(event.duration))) {\n      alert(\"That room is unavailable\");\n    } else if (!validateTeacher(otherEvents, resourceId, start, parseInt(event.duration))) {\n      alert(\"That teacher is unavailable\");\n    } else {\n      moveEvent({\n        event,\n        resourceId,\n        start,\n        end\n      });\n    }\n  };\n\n  const handleAddEvent = newEvent => {\n    addLesson(events, newEvent, setEvents);\n    setFormType(\"event\");\n  };\n\n  const handleChangeEvent = event => {\n    changeEvent(events, event, setEvents);\n    setFormType(\"event\");\n  };\n\n  const handleSelect = ({\n    start\n  }) => {\n    setFormType(\"event\");\n    updateStartTime(start);\n  };\n\n  const handleDoubleClick = event => {\n    setSelectedEvent(event);\n    setFormType(\"event\");\n  };\n\n  const handleAddTeacher = newTeacher => {\n    addTeacher(teachers, newTeacher, setTeachers);\n    setFormType(\"\");\n  };\n\n  const handleBtnClick = () => {\n    setFormType(\"teacher\");\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, formType === \"event\" && React.createElement(EventForm, {\n    formType: formType,\n    setFormType: setFormType,\n    addEvent: handleAddEvent,\n    events: events,\n    teachers: teachers,\n    startTime: startTime,\n    updateStartTime: updateStartTime,\n    startTimeReset: startTimeReset,\n    changeEvent: handleChangeEvent,\n    selectedEvent: selectedEvent,\n    setEvents: setEvents,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }), formType === \"teacher\" && React.createElement(TeacherForm, {\n    formType: formType,\n    setFormType: setFormType,\n    addTeacher: handleAddTeacher,\n    setTeachers: setTeachers,\n    teachers: teachers,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    onClick: handleBtnClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"New Teacher\"), React.createElement(CustomDnDCalendar, {\n    handleMove: handleMove,\n    handleSelect: handleSelect,\n    handleDoubleClick: handleDoubleClick,\n    events: events,\n    teachers: teachers,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }));\n};\n\nexport default Schedule;","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/frontend/src/components/Schedule.js"],"names":["React","useState","useEffect","CustomDnDCalendar","EventForm","TeacherForm","useFormState","validateRoom","validateTeacher","addTeachingMins","getTeachers","getLessons","addLesson","addTeacher","updateTeacher","changeEvent","Schedule","formType","setFormType","id","title","start","Date","end","room","duration","resourceId","hide","events","setEvents","teachers","setTeachers","startTime","updateStartTime","startTimeReset","selectedEvent","setSelectedEvent","moveEvent","event","idx","indexOf","updatedEvent","nextEvents","splice","handleMove","otherEvents","slice","parseInt","alert","handleAddEvent","newEvent","handleChangeEvent","handleSelect","handleDoubleClick","handleAddTeacher","newTeacher","handleBtnClick"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\n\nimport CustomDnDCalendar from \"./CustomDnDCalendar\";\nimport EventForm from \"./EventForm\";\nimport TeacherForm from \"./TeacherForm\";\nimport useFormState from \"../hooks/useInputState\";\nimport { validateRoom, validateTeacher } from \"../validators\";\nimport {\n  addTeachingMins,\n  getTeachers,\n  getLessons,\n  addLesson,\n  addTeacher,\n  updateTeacher,\n  changeEvent\n} from \"../helperFunctions\";\n\nimport \"react-big-calendar/lib/sass/styles.scss\";\nimport \"react-big-calendar/lib/addons/dragAndDrop/styles.scss\";\n\nconst Schedule = () => {\n  const [formType, setFormType] = useState(\"\");\n  const [events, setEvents] = useState([\n    {\n      id: 1,\n      title: \"Dummy Event to fix drag and drop bug\",\n      start: new Date(),\n      end: new Date(),\n      room: 2,\n      duration: 0,\n      resourceId: 1,\n      hide: true\n    }\n  ]);\n  const [teachers, setTeachers] = useState([]);\n  const [startTime, updateStartTime, startTimeReset] = useFormState(new Date());\n  const [selectedEvent, setSelectedEvent] = useState(\"\");\n\n  useEffect(() => {\n    getLessons(events, setEvents);\n    getTeachers(setTeachers);\n  }, []);\n\n  useEffect(() => {\n    addTeachingMins(events, teachers, setTeachers);\n  }, [events]);\n\n  const moveEvent = ({ event, resourceId, start, end }) => {\n    const idx = events.indexOf(event);\n\n    const updatedEvent = { ...event, resourceId, start, end };\n\n    const nextEvents = [...events];\n    nextEvents.splice(idx, 1, updatedEvent);\n\n    setEvents(nextEvents);\n    // alert(`${event.title} was dropped onto ${updatedEvent.start}`)\n  };\n\n  const handleMove = ({ event, resourceId, start, end }) => {\n    const idx = events.indexOf(event);\n    const otherEvents = [...events.slice(0, idx), ...events.slice(idx + 1)];\n    if (\n      !validateRoom(otherEvents, event.room, start, parseInt(event.duration))\n    ) {\n      alert(\"That room is unavailable\");\n    } else if (\n      !validateTeacher(otherEvents, resourceId, start, parseInt(event.duration))\n    ) {\n      alert(\"That teacher is unavailable\");\n    } else {\n      moveEvent({\n        event,\n        resourceId,\n        start,\n        end\n      });\n    }\n  };\n\n  const handleAddEvent = newEvent => {\n    addLesson(events, newEvent, setEvents);\n    setFormType(\"event\");\n  };\n\n  const handleChangeEvent = event => {\n    changeEvent(events, event, setEvents);\n    setFormType(\"event\");\n  };\n\n  const handleSelect = ({ start }) => {\n    setFormType(\"event\");\n    updateStartTime(start);\n  };\n\n  const handleDoubleClick = event => {\n    setSelectedEvent(event);\n    setFormType(\"event\");\n  };\n\n  const handleAddTeacher = newTeacher => {\n    addTeacher(teachers, newTeacher, setTeachers);\n    setFormType(\"\");\n  };\n\n  const handleBtnClick = () => {\n    setFormType(\"teacher\");\n  };\n\n  return (\n    <div>\n      {formType === \"event\" && (\n        <EventForm\n          formType={formType}\n          setFormType={setFormType}\n          addEvent={handleAddEvent}\n          events={events}\n          teachers={teachers}\n          startTime={startTime}\n          updateStartTime={updateStartTime}\n          startTimeReset={startTimeReset}\n          changeEvent={handleChangeEvent}\n          selectedEvent={selectedEvent}\n          setEvents={setEvents}\n        />\n      )}\n      {formType === \"teacher\" && (\n        <TeacherForm\n          formType={formType}\n          setFormType={setFormType}\n          addTeacher={handleAddTeacher}\n          setTeachers={setTeachers}\n          teachers={teachers}\n        />\n      )}\n      <button onClick={handleBtnClick}>New Teacher</button>\n      <CustomDnDCalendar\n        handleMove={handleMove}\n        handleSelect={handleSelect}\n        handleDoubleClick={handleDoubleClick}\n        events={events}\n        teachers={teachers}\n      />\n    </div>\n  );\n};\nexport default Schedule;\n"]},"metadata":{},"sourceType":"module"}