{"ast":null,"code":"import _slicedToArray from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport { addNewEvent } from \"../helperFunctions\";\nexport default function (initialEvents) {\n  const _useState = useState(initialEvents),\n        _useState2 = _slicedToArray(_useState, 2),\n        events = _useState2[0],\n        setEvents = _useState2[1];\n\n  const CancelToken = CancelToken.source();\n  const testObj = {\n    events,\n    getEvents: async function (dateTime) {\n      return await axios.get(\"/lessons/\", {\n        cancelToken: source.token\n      }).then(res => {\n        if (res.data.length > 0) {\n          res.data.forEach(event => {\n            event.start = new Date(event.start);\n            event.end = new Date(event.end); // Check if last recurrence, and if so, create two more months of recurrences\n\n            if (event.isLast) {\n              if (dateTime >= event.start.getTime()) {\n                addNewEvent(event);\n              }\n            }\n          });\n          return setEvents([...res.data, events[0]]);\n        }\n      }).catch(err => console.log(err));\n    },\n    addEvent: async function (event) {\n      const newEvents = addNewEvent(event);\n      setEvents([...events, ...newEvents]);\n      await axios.post(\"/lessons/add\", {\n        cancelToken: source.token\n      }, newEvents).then(res => console.log(res.data)).catch(err => console.log(err));\n    },\n    deleteEvent: async function (event) {\n      const newEvents = events.filter(evt => evt._id !== event._id);\n      setEvents(newEvents);\n      return await axios.delete(`/lessons/delete/${event._id}`, {\n        cancelToken: source.token\n      }).then(res => console.log(res.data)).catch(err => console.log(err));\n    },\n    editEvent: async function (event, editedEvent) {\n      const idx = events.findIndex(e => e._id === event._id);\n      const nextEvents = [...events];\n      nextEvents.splice(idx, 1, editedEvent);\n      setEvents(nextEvents);\n      return await axios.put(`/lessons/update/${event._id}`, editedEvent).then(res => console.log(res.data)).catch(err => console.log(err));\n    }\n  };\n  return testObj;\n}","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/hooks/useEventsState.js"],"names":["useState","axios","addNewEvent","initialEvents","events","setEvents","CancelToken","source","testObj","getEvents","dateTime","get","cancelToken","token","then","res","data","length","forEach","event","start","Date","end","isLast","getTime","catch","err","console","log","addEvent","newEvents","post","deleteEvent","filter","evt","_id","delete","editEvent","editedEvent","idx","findIndex","e","nextEvents","splice","put"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport axios from \"axios\";\nimport { addNewEvent } from \"../helperFunctions\";\n\nexport default function(initialEvents) {\n  const [events, setEvents] = useState(initialEvents);\n  const CancelToken = CancelToken.source();\n\n  const testObj = {\n    events,\n    getEvents: async function(dateTime) {\n      return await axios\n        .get(\"/lessons/\", { cancelToken: source.token })\n        .then(res => {\n          if (res.data.length > 0) {\n            res.data.forEach(event => {\n              event.start = new Date(event.start);\n              event.end = new Date(event.end);\n              // Check if last recurrence, and if so, create two more months of recurrences\n              if (event.isLast) {\n                if (dateTime >= event.start.getTime()) {\n                  addNewEvent(event);\n                }\n              }\n            });\n            return setEvents([...res.data, events[0]]);\n          }\n        })\n        .catch(err => console.log(err));\n    },\n    addEvent: async function(event) {\n      const newEvents = addNewEvent(event);\n      setEvents([...events, ...newEvents]);\n      await axios\n        .post(\"/lessons/add\", { cancelToken: source.token }, newEvents)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    },\n    deleteEvent: async function(event) {\n      const newEvents = events.filter(evt => evt._id !== event._id);\n      setEvents(newEvents);\n      return await axios\n        .delete(`/lessons/delete/${event._id}`, { cancelToken: source.token })\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    },\n    editEvent: async function(event, editedEvent) {\n      const idx = events.findIndex(e => e._id === event._id);\n      const nextEvents = [...events];\n\n      nextEvents.splice(idx, 1, editedEvent);\n      setEvents(nextEvents);\n      return await axios\n        .put(`/lessons/update/${event._id}`, editedEvent)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    }\n  };\n\n  return testObj;\n}\n"]},"metadata":{},"sourceType":"module"}