{"ast":null,"code":"import _objectSpread from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport axios from \"axios\";\nimport { createPayPeriodData } from \"../helperFunctions\";\nimport uuid from \"uuid/v4\";\n\nconst updateTeacher = async teacher => {\n  await axios.put(`/teachers/update/${teacher._id}`, teacher).then(res => console.log(res.data)).catch(err => console.log(err));\n  return state.map(t => t.id === action.id ? _objectSpread({}, t, {\n    resourceTitle: t.resourceTitle,\n    name: t.name,\n    familyName: t.familyName,\n    teachingMins: t.teachingMins,\n    holidayMins: t.holidayMins,\n    outsideDutyMins: t.outsideDutyMins,\n    otThreshold: t.otThreshold,\n    overThresholdOneMins: t.overThresholdOneMins,\n    overThresholdTwoMins: t.overThresholdTwoMins\n  }) : t);\n};\n\nconst reducer = async (state, action) => {\n  const teacher = action.teacher && action.Teacher;\n  const events = action.events && action.events;\n\n  switch (action.type) {\n    case \"GET_TEACHERS\":\n      let teachersArr;\n      await axios.get(\"/teachers/\").then(res => {\n        teachersArr = res.data;\n      }).catch(err => console.log(err));\n      return [...state, teachersArr];\n\n    case \"ADD_TEACHER\":\n      await axios.post(\"/teachers/add\", teacher).then(res => console.log(res.data)).catch(err => console.log(err));\n      return [...state, {\n        id: uuid(),\n        teacher\n      }];\n\n    case \"DELETE_TEACHER\":\n      await axios.delete(`/teachers/delete/${teacher._id}`).then(res => console.log(res.data)).catch(err => console.log(err));\n      return state.filter(t => t.id !== action.id);\n\n    case \"UPDATE_TEACHER\":\n      updateTeacher(teacher);\n\n    case \"CALC_TEACHING_MINS\":\n      const now = new Date(); // Create start and end dates for the current month to calc\n      // teaching minutes\n\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n\n      if (state.length > 0) {\n        // Reset teaching minutes to \"0\", then add all teaching minutes to the corresponding instructor\n        state.forEach(t => {\n          t.teachingMins = 0;\n          t.outsideDutyMins = 0;\n          t.holidayMins = 0;\n          t.overThresholdOneMins = 0;\n          t.overThresholdTwoMins = 0;\n          createPayPeriodData(events, teacher, monthStart, monthEnd);\n          updateTeacher(t);\n        });\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/reducers/teachersReducer.js"],"names":["axios","createPayPeriodData","uuid","updateTeacher","teacher","put","_id","then","res","console","log","data","catch","err","state","map","t","id","action","resourceTitle","name","familyName","teachingMins","holidayMins","outsideDutyMins","otThreshold","overThresholdOneMins","overThresholdTwoMins","reducer","Teacher","events","type","teachersArr","get","post","delete","filter","now","Date","monthStart","getFullYear","getMonth","monthEnd","length","forEach"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { createPayPeriodData } from \"../helperFunctions\";\nimport uuid from \"uuid/v4\";\n\nconst updateTeacher = async teacher => {\n  await axios\n    .put(`/teachers/update/${teacher._id}`, teacher)\n    .then(res => console.log(res.data))\n    .catch(err => console.log(err));\n  return state.map(t =>\n    t.id === action.id\n      ? {\n          ...t,\n          resourceTitle: t.resourceTitle,\n          name: t.name,\n          familyName: t.familyName,\n          teachingMins: t.teachingMins,\n          holidayMins: t.holidayMins,\n          outsideDutyMins: t.outsideDutyMins,\n          otThreshold: t.otThreshold,\n          overThresholdOneMins: t.overThresholdOneMins,\n          overThresholdTwoMins: t.overThresholdTwoMins\n        }\n      : t\n  );\n};\n\nconst reducer = async (state, action) => {\n  const teacher = action.teacher && action.Teacher;\n  const events = action.events && action.events;\n\n  switch (action.type) {\n    case \"GET_TEACHERS\":\n      let teachersArr;\n      await axios\n        .get(\"/teachers/\")\n        .then(res => {\n          teachersArr = res.data;\n        })\n        .catch(err => console.log(err));\n      return [...state, teachersArr];\n\n    case \"ADD_TEACHER\":\n      await axios\n        .post(\"/teachers/add\", teacher)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n      return [...state, { id: uuid(), teacher }];\n\n    case \"DELETE_TEACHER\":\n      await axios\n        .delete(`/teachers/delete/${teacher._id}`)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n      return state.filter(t => t.id !== action.id);\n\n    case \"UPDATE_TEACHER\":\n      updateTeacher(teacher);\n\n    case \"CALC_TEACHING_MINS\":\n      const now = new Date();\n      // Create start and end dates for the current month to calc\n      // teaching minutes\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n      if (state.length > 0) {\n        // Reset teaching minutes to \"0\", then add all teaching minutes to the corresponding instructor\n        state.forEach(t => {\n          t.teachingMins = 0;\n          t.outsideDutyMins = 0;\n          t.holidayMins = 0;\n          t.overThresholdOneMins = 0;\n          t.overThresholdTwoMins = 0;\n\n          createPayPeriodData(events, teacher, monthStart, monthEnd);\n          updateTeacher(t);\n        });\n      }\n    default:\n      return state;\n  }\n};\nexport default reducer;\n"]},"metadata":{},"sourceType":"module"}