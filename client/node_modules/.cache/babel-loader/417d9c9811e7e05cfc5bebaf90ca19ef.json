{"ast":null,"code":"import _objectSpread from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport { createPayPeriodData } from \"../helperFunctions\";\nexport default (initialTeachers => {\n  const _useState = useState(initialTeachers),\n        _useState2 = _slicedToArray(_useState, 2),\n        teachers = _useState2[0],\n        setTeachers = _useState2[1];\n\n  return {\n    teachers,\n    getTeachers: async events => {\n      return await axios.get(\"/teachers/\").then(res => {\n        if (res.data.length > 0) {\n          setTeachers(res.data);\n        }\n\n        this.addTeachingMins(events, teachers);\n      }).catch(err => console.log(err));\n    },\n    addTeacher: async newTeacher => {\n      await axios.post(\"/teachers/add\", newTeacher).then(res => console.log(res.data)).catch(err => console.log(err));\n      return setTeachers([...teachers, newTeacher]);\n    },\n    updateTeacher: async teacher => {\n      const idx = teachers.findIndex(t => t._id === teacher._id);\n      const updatedTeachers = [...teachers];\n\n      const updatedTeacher = _objectSpread({}, teacher, {\n        resourceTitle: teacher.resourceTitle,\n        name: teacher.name,\n        familyName: teacher.familyName,\n        teachingMins: teacher.teachingMins,\n        holidayMins: teacher.holidayMins,\n        outsideDutyMins: teacher.outsideDutyMins,\n        otThreshold: teacher.otThreshold,\n        overThresholdOneMins: teacher.overThresholdOneMins,\n        overThresholdTwoMins: teacher.overThresholdTwoMins\n      });\n\n      updatedTeachers.splice(idx, 1, updatedTeacher);\n      setTeachers(updatedTeachers);\n      return await axios.put(`/teachers/update/${teacher._id}`, updatedTeacher).then(res => console.log(res.data)).catch(err => console.log(err));\n    },\n    deleteTeacher: async teacher => {\n      return await axios.delete(`/teachers/delete/${teacher._id}`).then(res => console.log(res.data)).catch(err => console.log(err));\n    },\n    addTeachingMins: events => {\n      const now = new Date(); // Create start and end dates for the current month to calc\n      // teaching minutes\n\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n\n      if (teachers.length > 0) {\n        // Reset teaching minutes to \"0\", then add all teaching minutes to the corresponding instructor\n        teachers.forEach(teacher => {\n          teacher.teachingMins = 0;\n          teacher.outsideDutyMins = 0;\n          teacher.holidayMins = 0;\n          teacher.overThresholdOneMins = 0;\n          teacher.overThresholdTwoMins = 0;\n        });\n        teachers.forEach(teacher => {\n          createPayPeriodData(events, teacher, monthStart, monthEnd);\n          this.updateTeacher(teacher, teachers, setTeachers);\n        });\n      }\n    }\n  };\n});","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/hooks/useTeachersState.js"],"names":["useState","axios","createPayPeriodData","initialTeachers","teachers","setTeachers","getTeachers","events","get","then","res","data","length","addTeachingMins","catch","err","console","log","addTeacher","newTeacher","post","updateTeacher","teacher","idx","findIndex","t","_id","updatedTeachers","updatedTeacher","resourceTitle","name","familyName","teachingMins","holidayMins","outsideDutyMins","otThreshold","overThresholdOneMins","overThresholdTwoMins","splice","put","deleteTeacher","delete","now","Date","monthStart","getFullYear","getMonth","monthEnd","forEach"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport axios from \"axios\";\nimport { createPayPeriodData } from \"../helperFunctions\";\n\nexport default initialTeachers => {\n  const [teachers, setTeachers] = useState(initialTeachers);\n\n  return {\n    teachers,\n    getTeachers: async events => {\n      return await axios\n        .get(\"/teachers/\")\n        .then(res => {\n          if (res.data.length > 0) {\n            setTeachers(res.data);\n          }\n          this.addTeachingMins(events, teachers);\n        })\n        .catch(err => console.log(err));\n    },\n    addTeacher: async newTeacher => {\n      await axios\n        .post(\"/teachers/add\", newTeacher)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n      return setTeachers([...teachers, newTeacher]);\n    },\n    updateTeacher: async teacher => {\n      const idx = teachers.findIndex(t => t._id === teacher._id);\n      const updatedTeachers = [...teachers];\n\n      const updatedTeacher = {\n        ...teacher,\n        resourceTitle: teacher.resourceTitle,\n        name: teacher.name,\n        familyName: teacher.familyName,\n        teachingMins: teacher.teachingMins,\n        holidayMins: teacher.holidayMins,\n        outsideDutyMins: teacher.outsideDutyMins,\n        otThreshold: teacher.otThreshold,\n        overThresholdOneMins: teacher.overThresholdOneMins,\n        overThresholdTwoMins: teacher.overThresholdTwoMins\n      };\n      updatedTeachers.splice(idx, 1, updatedTeacher);\n\n      setTeachers(updatedTeachers);\n      return await axios\n        .put(`/teachers/update/${teacher._id}`, updatedTeacher)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    },\n    deleteTeacher: async teacher => {\n      return await axios\n        .delete(`/teachers/delete/${teacher._id}`)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    },\n    addTeachingMins: events => {\n      const now = new Date();\n      // Create start and end dates for the current month to calc\n      // teaching minutes\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n      if (teachers.length > 0) {\n        // Reset teaching minutes to \"0\", then add all teaching minutes to the corresponding instructor\n        teachers.forEach(teacher => {\n          teacher.teachingMins = 0;\n          teacher.outsideDutyMins = 0;\n          teacher.holidayMins = 0;\n          teacher.overThresholdOneMins = 0;\n          teacher.overThresholdTwoMins = 0;\n        });\n        teachers.forEach(teacher => {\n          createPayPeriodData(events, teacher, monthStart, monthEnd);\n          this.updateTeacher(teacher, teachers, setTeachers);\n        });\n      }\n    }\n  };\n};\n"]},"metadata":{},"sourceType":"module"}