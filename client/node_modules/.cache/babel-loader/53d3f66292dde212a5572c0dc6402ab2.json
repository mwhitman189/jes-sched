{"ast":null,"code":"import _objectSpread from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { createPayPeriodData } from \"../helperFunctions\";\nimport { tokenConfig } from \"../reducers/loadUserReducer\";\nimport { UserContext } from \"../context/UserContext\";\nexport default (initialTeachers => {\n  const _useContext = useContext(UserContext),\n        user = _useContext.user,\n        dispatch = _useContext.dispatch;\n\n  const _useState = useState(initialTeachers),\n        _useState2 = _slicedToArray(_useState, 2),\n        teachers = _useState2[0],\n        setTeachers = _useState2[1];\n\n  const updateTeacher = async teacher => {\n    const idx = teachers.findIndex(t => t._id === teacher._id);\n    const updatedTeachers = [...teachers];\n\n    const updatedTeacher = _objectSpread({}, teacher, {\n      resourceTitle: teacher.resourceTitle,\n      name: teacher.name,\n      familyName: teacher.familyName,\n      teachingMins: teacher.teachingMins,\n      holidayMins: teacher.holidayMins,\n      outsideDutyMins: teacher.outsideDutyMins,\n      otThreshold: teacher.otThreshold,\n      overThresholdOneMins: teacher.overThresholdOneMins,\n      overThresholdTwoMins: teacher.overThresholdTwoMins\n    });\n\n    updatedTeachers.splice(idx, 1, updatedTeacher);\n    setTeachers(updatedTeachers);\n    await axios.put(`/api/teachers/update/${teacher._id}`, updatedTeacher, tokenConfig(user)).then(res => console.log(res.data)).catch(err => console.log(err));\n  };\n\n  return {\n    teachers,\n    getTeachers: async () => {\n      await axios.get(\"/api/teachers\", tokenConfig(user)).then(res => {\n        if (res.data.length > 0) {\n          setTeachers(res.data);\n        }\n      }).catch(err => console.log(err));\n    },\n    addTeacher: async newTeacher => {\n      await axios.post(\"/api/teachers/add\", newTeacher, tokenConfig(user)).then(res => console.log(res.data)).catch(err => console.log(err));\n      return setTeachers([...teachers, newTeacher]);\n    },\n    deleteTeacher: async teacher => {\n      await axios.delete(`/api/teachers/delete/${teacher._id}`, tokenConfig(user)).then(res => console.log(res.data)).catch(err => console.log(err));\n    },\n    addTeachingMins: events => {\n      const now = new Date(); // Create start and end dates for the current month to calc\n      // teaching minutes\n\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n\n      if (teachers.length > 0) {\n        // Reset teaching minutes to \"0\", then add all teaching minutes to the corresponding instructor\n        teachers.forEach(teacher => {\n          teacher.teachingMins = 0;\n          teacher.outsideDutyMins = 0;\n          teacher.holidayMins = 0;\n          teacher.overThresholdOneMins = 0;\n          teacher.overThresholdTwoMins = 0;\n        });\n        teachers.forEach(teacher => {\n          createPayPeriodData(events, teacher, monthStart, monthEnd);\n          updateTeacher(teacher);\n        });\n      }\n    }\n  };\n});","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/hooks/useTeachersState.js"],"names":["useState","useContext","axios","createPayPeriodData","tokenConfig","UserContext","initialTeachers","user","dispatch","teachers","setTeachers","updateTeacher","teacher","idx","findIndex","t","_id","updatedTeachers","updatedTeacher","resourceTitle","name","familyName","teachingMins","holidayMins","outsideDutyMins","otThreshold","overThresholdOneMins","overThresholdTwoMins","splice","put","then","res","console","log","data","catch","err","getTeachers","get","length","addTeacher","newTeacher","post","deleteTeacher","delete","addTeachingMins","events","now","Date","monthStart","getFullYear","getMonth","monthEnd","forEach"],"mappings":"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","sourcesContent":["import { useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { createPayPeriodData } from \"../helperFunctions\";\nimport { tokenConfig } from \"../reducers/loadUserReducer\";\nimport { UserContext } from \"../context/UserContext\";\n\nexport default (initialTeachers) => {\n  const { user, dispatch } = useContext(UserContext);\n  const [teachers, setTeachers] = useState(initialTeachers);\n\n  const updateTeacher = async (teacher) => {\n    const idx = teachers.findIndex((t) => t._id === teacher._id);\n    const updatedTeachers = [...teachers];\n\n    const updatedTeacher = {\n      ...teacher,\n      resourceTitle: teacher.resourceTitle,\n      name: teacher.name,\n      familyName: teacher.familyName,\n      teachingMins: teacher.teachingMins,\n      holidayMins: teacher.holidayMins,\n      outsideDutyMins: teacher.outsideDutyMins,\n      otThreshold: teacher.otThreshold,\n      overThresholdOneMins: teacher.overThresholdOneMins,\n      overThresholdTwoMins: teacher.overThresholdTwoMins,\n    };\n    updatedTeachers.splice(idx, 1, updatedTeacher);\n\n    setTeachers(updatedTeachers);\n    await axios\n      .put(\n        `/api/teachers/update/${teacher._id}`,\n        updatedTeacher,\n        tokenConfig(user)\n      )\n      .then((res) => console.log(res.data))\n      .catch((err) => console.log(err));\n  };\n\n  return {\n    teachers,\n    getTeachers: async () => {\n      await axios\n        .get(\"/api/teachers\", tokenConfig(user))\n        .then((res) => {\n          if (res.data.length > 0) {\n            setTeachers(res.data);\n          }\n        })\n        .catch((err) => console.log(err));\n    },\n    addTeacher: async (newTeacher) => {\n      await axios\n        .post(\"/api/teachers/add\", newTeacher, tokenConfig(user))\n        .then((res) => console.log(res.data))\n        .catch((err) => console.log(err));\n      return setTeachers([...teachers, newTeacher]);\n    },\n    deleteTeacher: async (teacher) => {\n      await axios\n        .delete(`/api/teachers/delete/${teacher._id}`, tokenConfig(user))\n        .then((res) => console.log(res.data))\n        .catch((err) => console.log(err));\n    },\n    addTeachingMins: (events) => {\n      const now = new Date();\n      // Create start and end dates for the current month to calc\n      // teaching minutes\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n      if (teachers.length > 0) {\n        // Reset teaching minutes to \"0\", then add all teaching minutes to the corresponding instructor\n        teachers.forEach((teacher) => {\n          teacher.teachingMins = 0;\n          teacher.outsideDutyMins = 0;\n          teacher.holidayMins = 0;\n          teacher.overThresholdOneMins = 0;\n          teacher.overThresholdTwoMins = 0;\n        });\n\n        teachers.forEach((teacher) => {\n          createPayPeriodData(events, teacher, monthStart, monthEnd);\n          updateTeacher(teacher);\n        });\n      }\n    },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}