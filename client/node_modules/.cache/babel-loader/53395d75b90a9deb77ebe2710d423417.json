{"ast":null,"code":"import _toConsumableArray from\"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from\"react\";import CustomDnDCalendar from\"./CustomDnDCalendar\";import EventForm from\"./EventForm\";import TeacherForm from\"./TeacherForm\";import CustomizedSnackbars from\"./CustomizedSnackbars\";import Payroll from\"./Payroll\";import useFormState from\"../hooks/useInputState\";import useToggle from\"../hooks/useToggle\";import TeachersContext from\"../context/TeachersContext\";import{validateRoom,validateTeacher}from\"../validators\";import{addTeachingMins,getTeachers,getLessons,addLesson,addTeacher,changeEvent}from\"../helperFunctions\";import\"react-big-calendar/lib/sass/styles.scss\";import\"react-big-calendar/lib/addons/dragAndDrop/styles.scss\";var Schedule=function Schedule(){var _useContext=useContext(TeachersContext),teachers=_useContext.teachers,setTeachers=_useContext.setTeachers;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),formType=_useState2[0],setFormType=_useState2[1];var _useState3=useState([{id:1,title:\"Dummy Event to fix drag and drop bug\",start:new Date(),end:new Date(),room:2,duration:0,resourceId:1,hide:true}]),_useState4=_slicedToArray(_useState3,2),events=_useState4[0],setEvents=_useState4[1];var _useFormState=useFormState(new Date()),_useFormState2=_slicedToArray(_useFormState,3),startTime=_useFormState2[0],updateStartTime=_useFormState2[1],resetStartTime=_useFormState2[2];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),selectedEvent=_useState6[0],setSelectedEvent=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isOpen=_useState8[0],setIsOpen=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),message=_useState10[0],setMessage=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),selectedTeacher=_useState12[0],setSelectedTeacher=_useState12[1];var _useToggle=useToggle(false),_useToggle2=_slicedToArray(_useToggle,2),isRecurring=_useToggle2[0],toggleIsRecurring=_useToggle2[1];useEffect(function(){getLessons(events,setEvents);getTeachers(events,teachers,setTeachers);addTeachingMins(events,teachers,setTeachers);},[]);useEffect(function(){addTeachingMins(events,teachers,setTeachers);},[events,setTeachers]);var moveEvent=function moveEvent(_ref){var event=_ref.event,resourceId=_ref.resourceId,start=_ref.start,end=_ref.end;var updatedEvent=_objectSpread({},event,{resourceId:resourceId,start:start,end:end});handleDoubleClick(event);changeEvent(events,event,updatedEvent,setEvents);};// Add validation to a move upon dropping an event with drag and drop\n// If there is a conflict, prevent the move and flash a conflict snackbar\nvar handleMove=function handleMove(_ref2){var event=_ref2.event,resourceId=_ref2.resourceId,start=_ref2.start,end=_ref2.end;var idx=events.indexOf(event);var otherEvents=[].concat(_toConsumableArray(events.slice(0,idx)),_toConsumableArray(events.slice(idx+1)));if(!validateRoom(otherEvents,event.room,start,parseInt(event.duration))){setSelectedEvent(event);handleToggleSnackbar(\"Room Conflict. Please choose another room or time\");return 1;}if(!validateTeacher(otherEvents,resourceId,start,parseInt(event.duration))){setSelectedEvent(event);handleToggleSnackbar(\"Teacher Conflict. Please choose another teacher or time\");return 1;}moveEvent({event:event,resourceId:resourceId,start:start,end:end});return 0;};var handleAddEvent=function handleAddEvent(newEvent){addLesson(events,newEvent,setEvents);setFormType(\"\");};var handleSelect=function handleSelect(_ref3){var start=_ref3.start,resourceId=_ref3.resourceId;updateStartTime(start);setSelectedTeacher(resourceId);setFormType(\"event\");};var handleDoubleClick=function handleDoubleClick(event){updateStartTime(event.start);setSelectedEvent(event);setFormType(\"event\");};var handleAddTeacher=function handleAddTeacher(newTeacher){addTeacher(teachers,newTeacher,setTeachers);setFormType(\"\");};var handleBtnClick=function handleBtnClick(){setFormType(\"teacher\");};var handleToggleSnackbar=function handleToggleSnackbar(msg){setMessage(msg);setIsOpen(true);};var handlePayrollBtnClick=function handlePayrollBtnClick(){setFormType(\"payroll\");};return React.createElement(\"div\",null,formType===\"event\"&&React.createElement(EventForm,{formType:formType,setFormType:setFormType,addEvent:handleAddEvent,events:events,teachers:teachers,startTime:startTime,updateStartTime:updateStartTime,resetStartTime:resetStartTime,event:selectedEvent,setSelectedEvent:setSelectedEvent,setEvents:setEvents,selectedTeacher:selectedTeacher,isRecurring:isRecurring,toggleIsRecurring:toggleIsRecurring}),formType===\"teacher\"&&React.createElement(TeacherForm,{formType:formType,setFormType:setFormType,addTeacher:handleAddTeacher,setTeachers:setTeachers,teachers:teachers}),formType===\"payroll\"&&React.createElement(Payroll,{events:events,setFormType:setFormType}),React.createElement(CustomizedSnackbars,{isOpen:isOpen,setIsOpen:setIsOpen,variant:\"error\",msg:message,events:events}),React.createElement(CustomDnDCalendar,{handleMove:handleMove,handleSelect:handleSelect,handleDoubleClick:handleDoubleClick,events:events,setEvents:setEvents,teachers:teachers,handleBtnClick:handleBtnClick,handlePayrollBtnClick:handlePayrollBtnClick}));};export default Schedule;","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/components/Schedule.js"],"names":["React","useState","useEffect","useContext","CustomDnDCalendar","EventForm","TeacherForm","CustomizedSnackbars","Payroll","useFormState","useToggle","TeachersContext","validateRoom","validateTeacher","addTeachingMins","getTeachers","getLessons","addLesson","addTeacher","changeEvent","Schedule","teachers","setTeachers","formType","setFormType","id","title","start","Date","end","room","duration","resourceId","hide","events","setEvents","startTime","updateStartTime","resetStartTime","selectedEvent","setSelectedEvent","isOpen","setIsOpen","message","setMessage","selectedTeacher","setSelectedTeacher","isRecurring","toggleIsRecurring","moveEvent","event","updatedEvent","handleDoubleClick","handleMove","idx","indexOf","otherEvents","slice","parseInt","handleToggleSnackbar","handleAddEvent","newEvent","handleSelect","handleAddTeacher","newTeacher","handleBtnClick","msg","handlePayrollBtnClick"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\n\nimport CustomDnDCalendar from \"./CustomDnDCalendar\";\nimport EventForm from \"./EventForm\";\nimport TeacherForm from \"./TeacherForm\";\nimport CustomizedSnackbars from \"./CustomizedSnackbars\";\nimport Payroll from \"./Payroll\";\nimport useFormState from \"../hooks/useInputState\";\nimport useToggle from \"../hooks/useToggle\";\nimport TeachersContext from \"../context/TeachersContext\";\n\nimport { validateRoom, validateTeacher } from \"../validators\";\nimport {\n  addTeachingMins,\n  getTeachers,\n  getLessons,\n  addLesson,\n  addTeacher,\n  changeEvent\n} from \"../helperFunctions\";\n\nimport \"react-big-calendar/lib/sass/styles.scss\";\nimport \"react-big-calendar/lib/addons/dragAndDrop/styles.scss\";\n\nconst Schedule = () => {\n  const { teachers, setTeachers } = useContext(TeachersContext);\n  const [formType, setFormType] = useState(\"\");\n  const [events, setEvents] = useState([\n    {\n      id: 1,\n      title: \"Dummy Event to fix drag and drop bug\",\n      start: new Date(),\n      end: new Date(),\n      room: 2,\n      duration: 0,\n      resourceId: 1,\n      hide: true\n    }\n  ]);\n  const [startTime, updateStartTime, resetStartTime] = useFormState(new Date());\n  const [selectedEvent, setSelectedEvent] = useState(\"\");\n  const [isOpen, setIsOpen] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [selectedTeacher, setSelectedTeacher] = useState(\"\");\n  const [isRecurring, toggleIsRecurring] = useToggle(false);\n\n  useEffect(() => {\n    getLessons(events, setEvents);\n    getTeachers(events, teachers, setTeachers);\n    addTeachingMins(events, teachers, setTeachers);\n  }, []);\n\n  useEffect(() => {\n    addTeachingMins(events, teachers, setTeachers);\n  }, [events, setTeachers]);\n\n  const moveEvent = ({ event, resourceId, start, end }) => {\n    const updatedEvent = { ...event, resourceId, start, end };\n    handleDoubleClick(event);\n    changeEvent(events, event, updatedEvent, setEvents);\n  };\n\n  // Add validation to a move upon dropping an event with drag and drop\n  // If there is a conflict, prevent the move and flash a conflict snackbar\n  const handleMove = ({ event, resourceId, start, end }) => {\n    const idx = events.indexOf(event);\n    const otherEvents = [...events.slice(0, idx), ...events.slice(idx + 1)];\n    if (\n      !validateRoom(otherEvents, event.room, start, parseInt(event.duration))\n    ) {\n      setSelectedEvent(event);\n      handleToggleSnackbar(\"Room Conflict. Please choose another room or time\");\n      return 1;\n    }\n    if (\n      !validateTeacher(otherEvents, resourceId, start, parseInt(event.duration))\n    ) {\n      setSelectedEvent(event);\n      handleToggleSnackbar(\n        \"Teacher Conflict. Please choose another teacher or time\"\n      );\n      return 1;\n    }\n    moveEvent({\n      event,\n      resourceId,\n      start,\n      end\n    });\n    return 0;\n  };\n\n  const handleAddEvent = newEvent => {\n    addLesson(events, newEvent, setEvents);\n    setFormType(\"\");\n  };\n\n  const handleSelect = ({ start, resourceId }) => {\n    updateStartTime(start);\n    setSelectedTeacher(resourceId);\n    setFormType(\"event\");\n  };\n\n  const handleDoubleClick = event => {\n    updateStartTime(event.start);\n    setSelectedEvent(event);\n    setFormType(\"event\");\n  };\n\n  const handleAddTeacher = newTeacher => {\n    addTeacher(teachers, newTeacher, setTeachers);\n    setFormType(\"\");\n  };\n\n  const handleBtnClick = () => {\n    setFormType(\"teacher\");\n  };\n\n  const handleToggleSnackbar = msg => {\n    setMessage(msg);\n    setIsOpen(true);\n  };\n\n  const handlePayrollBtnClick = () => {\n    setFormType(\"payroll\");\n  };\n\n  return (\n    <div>\n      {formType === \"event\" && (\n        <EventForm\n          formType={formType}\n          setFormType={setFormType}\n          addEvent={handleAddEvent}\n          events={events}\n          teachers={teachers}\n          startTime={startTime}\n          updateStartTime={updateStartTime}\n          resetStartTime={resetStartTime}\n          event={selectedEvent}\n          setSelectedEvent={setSelectedEvent}\n          setEvents={setEvents}\n          selectedTeacher={selectedTeacher}\n          isRecurring={isRecurring}\n          toggleIsRecurring={toggleIsRecurring}\n        />\n      )}\n      {formType === \"teacher\" && (\n        <TeacherForm\n          formType={formType}\n          setFormType={setFormType}\n          addTeacher={handleAddTeacher}\n          setTeachers={setTeachers}\n          teachers={teachers}\n        />\n      )}\n      {formType === \"payroll\" && (\n        <Payroll events={events} setFormType={setFormType} />\n      )}\n      <CustomizedSnackbars\n        isOpen={isOpen}\n        setIsOpen={setIsOpen}\n        variant={\"error\"}\n        msg={message}\n        events={events}\n      />\n      <CustomDnDCalendar\n        handleMove={handleMove}\n        handleSelect={handleSelect}\n        handleDoubleClick={handleDoubleClick}\n        events={events}\n        setEvents={setEvents}\n        teachers={teachers}\n        handleBtnClick={handleBtnClick}\n        handlePayrollBtnClick={handlePayrollBtnClick}\n      />\n    </div>\n  );\n};\nexport default Schedule;\n"]},"metadata":{},"sourceType":"module"}