{"ast":null,"code":"import _objectSpread from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport { getRecurrences, getEvents } from \"../helperFunctions\";\nexport default function (initialEvents) {\n  const _useState = useState(initialEvents),\n        _useState2 = _slicedToArray(_useState, 2),\n        events = _useState2[0],\n        setEvents = _useState2[1];\n\n  const JapaneseHolidays = require(\"japanese-holidays\");\n\n  const addEvent = async function (event) {\n    const newEvents = [];\n\n    if (event.recur === true) {\n      const recurrences = getRecurrences(event);\n      recurrences.map(r => {\n        const newEvent = _objectSpread({}, event, {\n          start: r,\n          end: moment(r).add(event.duration, \"m\").toDate(),\n          isNewEvent: false\n        });\n\n        if (JapaneseHolidays.isHoliday(r)) {\n          newEvent.isHoliday = true;\n        }\n\n        newEvents.push(newEvent);\n        newEvents[newEvents.length - 1].isLast = true;\n      });\n    }\n\n    if (JapaneseHolidays.isHoliday(event.start)) {\n      event = _objectSpread({}, event, {\n        isHoliday: true\n      });\n    }\n\n    event = _objectSpread({}, event, {\n      isNewEvent: true\n    });\n    newEvents.unshift(event);\n    setEvents([...events, ...newEvents]);\n    return await axios.post(\"/lessons/add\", newEvents).then(res => console.log(res.data)).catch(err => console.log(err));\n  };\n\n  const testObj = {\n    events,\n    addEvent: async function (event) {\n      const newEvents = [];\n\n      if (event.recur === true) {\n        const recurrences = getRecurrences(event);\n        recurrences.map(r => {\n          const newEvent = _objectSpread({}, event, {\n            start: r,\n            end: moment(r).add(event.duration, \"m\").toDate(),\n            isNewEvent: false,\n            isLast: false\n          });\n\n          if (JapaneseHolidays.isHoliday(r)) {\n            newEvent.isHoliday = true;\n          }\n\n          newEvents.push(newEvent);\n        });\n        newEvents[newEvents.length - 1].isLast = true;\n      }\n\n      if (JapaneseHolidays.isHoliday(event.start)) {\n        event = _objectSpread({}, event, {\n          isHoliday: true\n        });\n      }\n\n      event = _objectSpread({}, event, {\n        isNewEvent: true\n      });\n      newEvents.unshift(event);\n      await axios.post(\"/lessons/add\", newEvents).then(res => console.log(res.data)).catch(err => console.log(err));\n      return this.getEvents();\n    },\n    deleteEvent: async function (event) {\n      const newEvents = events.filter(evt => evt._id !== event._id);\n      setEvents(newEvents);\n      return await axios.delete(`/lessons/delete/${event._id}`).then(res => console.log(res.data)).catch(err => console.log(err));\n    },\n    editEvent: async function (event, editedEvent) {\n      const idx = events.findIndex(e => e._id === event._id);\n      const nextEvents = [...events];\n      nextEvents.splice(idx, 1, editedEvent);\n      setEvents(nextEvents);\n      return await axios.put(`/lessons/update/${event._id}`, editedEvent).then(res => console.log(res.data)).catch(err => console.log(err));\n    }\n  };\n  return testObj;\n}","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/hooks/useEventsState.js"],"names":["useState","axios","moment","getRecurrences","getEvents","initialEvents","events","setEvents","JapaneseHolidays","require","addEvent","event","newEvents","recur","recurrences","map","r","newEvent","start","end","add","duration","toDate","isNewEvent","isHoliday","push","length","isLast","unshift","post","then","res","console","log","data","catch","err","testObj","deleteEvent","filter","evt","_id","delete","editEvent","editedEvent","idx","findIndex","e","nextEvents","splice","put"],"mappings":";;AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,cAAT,EAAyBC,SAAzB,QAA0C,oBAA1C;AAEA,eAAe,UAASC,aAAT,EAAwB;AAAA,oBACTL,QAAQ,CAACK,aAAD,CADC;AAAA;AAAA,QAC9BC,MAD8B;AAAA,QACtBC,SADsB;;AAErC,QAAMC,gBAAgB,GAAGC,OAAO,CAAC,mBAAD,CAAhC;;AAEA,QAAMC,QAAQ,GAAG,gBAAeC,KAAf,EAAsB;AACrC,UAAMC,SAAS,GAAG,EAAlB;;AACA,QAAID,KAAK,CAACE,KAAN,KAAgB,IAApB,EAA0B;AACxB,YAAMC,WAAW,GAAGX,cAAc,CAACQ,KAAD,CAAlC;AACAG,MAAAA,WAAW,CAACC,GAAZ,CAAgBC,CAAC,IAAI;AACnB,cAAMC,QAAQ,qBACTN,KADS;AAEZO,UAAAA,KAAK,EAAEF,CAFK;AAGZG,UAAAA,GAAG,EAAEjB,MAAM,CAACc,CAAD,CAAN,CACFI,GADE,CACET,KAAK,CAACU,QADR,EACkB,GADlB,EAEFC,MAFE,EAHO;AAMZC,UAAAA,UAAU,EAAE;AANA,UAAd;;AAQA,YAAIf,gBAAgB,CAACgB,SAAjB,CAA2BR,CAA3B,CAAJ,EAAmC;AACjCC,UAAAA,QAAQ,CAACO,SAAT,GAAqB,IAArB;AACD;;AACDZ,QAAAA,SAAS,CAACa,IAAV,CAAeR,QAAf;AACAL,QAAAA,SAAS,CAACA,SAAS,CAACc,MAAV,GAAmB,CAApB,CAAT,CAAgCC,MAAhC,GAAyC,IAAzC;AACD,OAdD;AAeD;;AACD,QAAInB,gBAAgB,CAACgB,SAAjB,CAA2Bb,KAAK,CAACO,KAAjC,CAAJ,EAA6C;AAC3CP,MAAAA,KAAK,qBAAQA,KAAR;AAAea,QAAAA,SAAS,EAAE;AAA1B,QAAL;AACD;;AACDb,IAAAA,KAAK,qBAAQA,KAAR;AAAeY,MAAAA,UAAU,EAAE;AAA3B,MAAL;AACAX,IAAAA,SAAS,CAACgB,OAAV,CAAkBjB,KAAlB;AACAJ,IAAAA,SAAS,CAAC,CAAC,GAAGD,MAAJ,EAAY,GAAGM,SAAf,CAAD,CAAT;AAEA,WAAO,MAAMX,KAAK,CACf4B,IADU,CACL,cADK,EACWjB,SADX,EAEVkB,IAFU,CAELC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,CAFF,EAGVC,KAHU,CAGJC,GAAG,IAAIJ,OAAO,CAACC,GAAR,CAAYG,GAAZ,CAHH,CAAb;AAID,GA/BD;;AAiCA,QAAMC,OAAO,GAAG;AACd/B,IAAAA,MADc;AAEdI,IAAAA,QAAQ,EAAE,gBAAeC,KAAf,EAAsB;AAC9B,YAAMC,SAAS,GAAG,EAAlB;;AACA,UAAID,KAAK,CAACE,KAAN,KAAgB,IAApB,EAA0B;AACxB,cAAMC,WAAW,GAAGX,cAAc,CAACQ,KAAD,CAAlC;AACAG,QAAAA,WAAW,CAACC,GAAZ,CAAgBC,CAAC,IAAI;AACnB,gBAAMC,QAAQ,qBACTN,KADS;AAEZO,YAAAA,KAAK,EAAEF,CAFK;AAGZG,YAAAA,GAAG,EAAEjB,MAAM,CAACc,CAAD,CAAN,CACFI,GADE,CACET,KAAK,CAACU,QADR,EACkB,GADlB,EAEFC,MAFE,EAHO;AAMZC,YAAAA,UAAU,EAAE,KANA;AAOZI,YAAAA,MAAM,EAAE;AAPI,YAAd;;AASA,cAAInB,gBAAgB,CAACgB,SAAjB,CAA2BR,CAA3B,CAAJ,EAAmC;AACjCC,YAAAA,QAAQ,CAACO,SAAT,GAAqB,IAArB;AACD;;AACDZ,UAAAA,SAAS,CAACa,IAAV,CAAeR,QAAf;AACD,SAdD;AAeAL,QAAAA,SAAS,CAACA,SAAS,CAACc,MAAV,GAAmB,CAApB,CAAT,CAAgCC,MAAhC,GAAyC,IAAzC;AACD;;AACD,UAAInB,gBAAgB,CAACgB,SAAjB,CAA2Bb,KAAK,CAACO,KAAjC,CAAJ,EAA6C;AAC3CP,QAAAA,KAAK,qBAAQA,KAAR;AAAea,UAAAA,SAAS,EAAE;AAA1B,UAAL;AACD;;AACDb,MAAAA,KAAK,qBAAQA,KAAR;AAAeY,QAAAA,UAAU,EAAE;AAA3B,QAAL;AACAX,MAAAA,SAAS,CAACgB,OAAV,CAAkBjB,KAAlB;AAEA,YAAMV,KAAK,CACR4B,IADG,CACE,cADF,EACkBjB,SADlB,EAEHkB,IAFG,CAEEC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,CAFT,EAGHC,KAHG,CAGGC,GAAG,IAAIJ,OAAO,CAACC,GAAR,CAAYG,GAAZ,CAHV,CAAN;AAIA,aAAO,KAAKhC,SAAL,EAAP;AACD,KAlCa;AAmCdkC,IAAAA,WAAW,EAAE,gBAAe3B,KAAf,EAAsB;AACjC,YAAMC,SAAS,GAAGN,MAAM,CAACiC,MAAP,CAAcC,GAAG,IAAIA,GAAG,CAACC,GAAJ,KAAY9B,KAAK,CAAC8B,GAAvC,CAAlB;AACAlC,MAAAA,SAAS,CAACK,SAAD,CAAT;AACA,aAAO,MAAMX,KAAK,CACfyC,MADU,CACF,mBAAkB/B,KAAK,CAAC8B,GAAI,EAD1B,EAEVX,IAFU,CAELC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,CAFF,EAGVC,KAHU,CAGJC,GAAG,IAAIJ,OAAO,CAACC,GAAR,CAAYG,GAAZ,CAHH,CAAb;AAID,KA1Ca;AA2CdO,IAAAA,SAAS,EAAE,gBAAehC,KAAf,EAAsBiC,WAAtB,EAAmC;AAC5C,YAAMC,GAAG,GAAGvC,MAAM,CAACwC,SAAP,CAAiBC,CAAC,IAAIA,CAAC,CAACN,GAAF,KAAU9B,KAAK,CAAC8B,GAAtC,CAAZ;AACA,YAAMO,UAAU,GAAG,CAAC,GAAG1C,MAAJ,CAAnB;AAEA0C,MAAAA,UAAU,CAACC,MAAX,CAAkBJ,GAAlB,EAAuB,CAAvB,EAA0BD,WAA1B;AACArC,MAAAA,SAAS,CAACyC,UAAD,CAAT;AAEA,aAAO,MAAM/C,KAAK,CACfiD,GADU,CACL,mBAAkBvC,KAAK,CAAC8B,GAAI,EADvB,EAC0BG,WAD1B,EAEVd,IAFU,CAELC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,CAFF,EAGVC,KAHU,CAGJC,GAAG,IAAIJ,OAAO,CAACC,GAAR,CAAYG,GAAZ,CAHH,CAAb;AAID;AAtDa,GAAhB;AAyDA,SAAOC,OAAP;AACD","sourcesContent":["import { useState } from \"react\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport { getRecurrences, getEvents } from \"../helperFunctions\";\n\nexport default function(initialEvents) {\n  const [events, setEvents] = useState(initialEvents);\n  const JapaneseHolidays = require(\"japanese-holidays\");\n\n  const addEvent = async function(event) {\n    const newEvents = [];\n    if (event.recur === true) {\n      const recurrences = getRecurrences(event);\n      recurrences.map(r => {\n        const newEvent = {\n          ...event,\n          start: r,\n          end: moment(r)\n            .add(event.duration, \"m\")\n            .toDate(),\n          isNewEvent: false\n        };\n        if (JapaneseHolidays.isHoliday(r)) {\n          newEvent.isHoliday = true;\n        }\n        newEvents.push(newEvent);\n        newEvents[newEvents.length - 1].isLast = true;\n      });\n    }\n    if (JapaneseHolidays.isHoliday(event.start)) {\n      event = { ...event, isHoliday: true };\n    }\n    event = { ...event, isNewEvent: true };\n    newEvents.unshift(event);\n    setEvents([...events, ...newEvents]);\n\n    return await axios\n      .post(\"/lessons/add\", newEvents)\n      .then(res => console.log(res.data))\n      .catch(err => console.log(err));\n  };\n\n  const testObj = {\n    events,\n    addEvent: async function(event) {\n      const newEvents = [];\n      if (event.recur === true) {\n        const recurrences = getRecurrences(event);\n        recurrences.map(r => {\n          const newEvent = {\n            ...event,\n            start: r,\n            end: moment(r)\n              .add(event.duration, \"m\")\n              .toDate(),\n            isNewEvent: false,\n            isLast: false\n          };\n          if (JapaneseHolidays.isHoliday(r)) {\n            newEvent.isHoliday = true;\n          }\n          newEvents.push(newEvent);\n        });\n        newEvents[newEvents.length - 1].isLast = true;\n      }\n      if (JapaneseHolidays.isHoliday(event.start)) {\n        event = { ...event, isHoliday: true };\n      }\n      event = { ...event, isNewEvent: true };\n      newEvents.unshift(event);\n\n      await axios\n        .post(\"/lessons/add\", newEvents)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n      return this.getEvents();\n    },\n    deleteEvent: async function(event) {\n      const newEvents = events.filter(evt => evt._id !== event._id);\n      setEvents(newEvents);\n      return await axios\n        .delete(`/lessons/delete/${event._id}`)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    },\n    editEvent: async function(event, editedEvent) {\n      const idx = events.findIndex(e => e._id === event._id);\n      const nextEvents = [...events];\n\n      nextEvents.splice(idx, 1, editedEvent);\n      setEvents(nextEvents);\n\n      return await axios\n        .put(`/lessons/update/${event._id}`, editedEvent)\n        .then(res => console.log(res.data))\n        .catch(err => console.log(err));\n    }\n  };\n\n  return testObj;\n}\n"]},"metadata":{},"sourceType":"module"}