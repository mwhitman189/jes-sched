{"ast":null,"code":"import _slicedToArray from\"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/home/miles/webdev/jes-sched/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";var _btn;import React,{useState,useContext,useRef}from\"react\";import moment from\"moment\";import ReactToPrint from\"react-to-print\";import TeachersContext from\"../context/TeachersContext\";import{createPayPeriodData}from\"../helperFunctions\";import PayrollSheet from\"./PayrollSheet\";import{makeStyles}from\"@material-ui/core/styles\";import Button from\"@material-ui/core/Button\";import Avatar from\"@material-ui/core/Avatar\";import List from\"@material-ui/core/List\";import ListItem from\"@material-ui/core/ListItem\";import ListItemAvatar from\"@material-ui/core/ListItemAvatar\";import ListItemText from\"@material-ui/core/ListItemText\";import Dialog from\"@material-ui/core/Dialog\";import PersonIcon from\"@material-ui/icons/Person\";import DialogTitle from\"@material-ui/core/DialogTitle\";import{blue}from\"@material-ui/core/colors\";var useStyles=makeStyles({avatar:{backgroundColor:blue[100],color:blue[600]},table:{padding:\"1rem\",maxWidth:\"90vw\"},btn:(_btn={color:\"#fff\",background:\"rgb(20,71,207)\"},_defineProperty(_btn,\"background\",\"linear-gradient(0deg, rgba(20,71,207,1) 7%, rgba(49,119,254,1) 100%)\"),_defineProperty(_btn,\"border\",\"none\"),_defineProperty(_btn,\"borderRadius\",\"5px\"),_defineProperty(_btn,\"padding\",\".3rem .5rem\"),_defineProperty(_btn,\"minWidth\",\"4rem\"),_defineProperty(_btn,\"margin\",\"1rem auto\"),_btn),footerRows:{width:\"100%\"},totals:{color:\"#21942a\",fontWeight:\"800\"}});function createData(date,month,teachingMins,outsideDutyMins,holidayMins,travelAllowance,travelExpenses){return{date:date,month:month,teachingMins:teachingMins,outsideDutyMins:outsideDutyMins,holidayMins:holidayMins,travelAllowance:travelAllowance,travelExpenses:travelExpenses};}var Payroll=function Payroll(props){var componentRef=useRef();var classes=useStyles();var _useContext=useContext(TeachersContext),teachers=_useContext.teachers;var _useState=useState(\"teacherSelect\"),_useState2=_slicedToArray(_useState,2),stage=_useState2[0],setStage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),rows=_useState4[0],setRows=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),currentTeacher=_useState6[0],setCurrentTeacher=_useState6[1];var events=props.events,setFormType=props.setFormType;var now=new Date();var monthStart=new Date(now.getFullYear(),now.getMonth(),1);var monthEnd=new Date(now.getFullYear(),now.getMonth()+1,0);var daysInMonth=moment(now).daysInMonth();var showPayrollSheet=function showPayrollSheet(teacher){setCurrentTeacher(teacher.resourceId);var teachingMinsByDate=createPayPeriodData(events,teacher,monthStart,monthEnd);var rows=[];for(var i=1;i<=daysInMonth;i++){var newRow=void 0;if(teachingMinsByDate[i]){newRow=createData(i,now.getMonth(\"MMM\"),teachingMinsByDate[i].teachingMins,teachingMinsByDate[i].outsideDutyMins,teachingMinsByDate[i].holidayMins,teachingMinsByDate[i].travelAllowance,teachingMinsByDate[i].travelExpenses);}else{newRow=createData(i,now.getMonth(\"MMM\"),0,0,0,0,0);}rows.push(newRow);}setRows(rows);setStage(\"payrollSheet\");};var hideForm=function hideForm(){setStage(\"\");setFormType(\"\");};return React.createElement(\"div\",null,React.createElement(Dialog,{onClose:hideForm,\"aria-labelledby\":\"teacher-select-title\",open:stage===\"teacherSelect\"},React.createElement(DialogTitle,{id:\"teacher-select-title\"},\"Payroll: Select a teacher\"),React.createElement(List,null,teachers.map(function(t){return React.createElement(ListItem,{button:true,onClick:function onClick(){return showPayrollSheet(t);},key:t.resourceId},React.createElement(ListItemAvatar,null,React.createElement(Avatar,{className:classes.avatar},React.createElement(PersonIcon,null))),React.createElement(ListItemText,{primary:t.name}));}))),React.createElement(Dialog,{onClose:hideForm,\"aria-labelledby\":\"payroll-sheet-dialog\",open:stage===\"payrollSheet\"},React.createElement(PayrollSheet,{classes:classes,rows:rows,currentTeacher:currentTeacher,ref:componentRef}),React.createElement(ReactToPrint,{trigger:function trigger(){return React.createElement(\"button\",{className:classes.btn},\"Print\");},content:function content(){return componentRef.current;}})));};export default Payroll;","map":{"version":3,"sources":["/home/miles/webdev/jes-sched/client/src/components/Payroll.js"],"names":["React","useState","useContext","useRef","moment","ReactToPrint","TeachersContext","createPayPeriodData","PayrollSheet","makeStyles","Button","Avatar","List","ListItem","ListItemAvatar","ListItemText","Dialog","PersonIcon","DialogTitle","blue","useStyles","avatar","backgroundColor","color","table","padding","maxWidth","btn","background","footerRows","width","totals","fontWeight","createData","date","month","teachingMins","outsideDutyMins","holidayMins","travelAllowance","travelExpenses","Payroll","props","componentRef","classes","teachers","stage","setStage","rows","setRows","currentTeacher","setCurrentTeacher","events","setFormType","now","Date","monthStart","getFullYear","getMonth","monthEnd","daysInMonth","showPayrollSheet","teacher","resourceId","teachingMinsByDate","i","newRow","push","hideForm","map","t","name","current"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useRef } from \"react\";\nimport moment from \"moment\";\nimport ReactToPrint from \"react-to-print\";\nimport TeachersContext from \"../context/TeachersContext\";\nimport { createPayPeriodData } from \"../helperFunctions\";\nimport PayrollSheet from \"./PayrollSheet\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Button from \"@material-ui/core/Button\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport PersonIcon from \"@material-ui/icons/Person\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n\nimport { blue } from \"@material-ui/core/colors\";\n\nconst useStyles = makeStyles({\n  avatar: {\n    backgroundColor: blue[100],\n    color: blue[600]\n  },\n  table: {\n    padding: \"1rem\",\n    maxWidth: \"90vw\"\n  },\n  btn: {\n    color: \"#fff\",\n    background: \"rgb(20,71,207)\",\n    background:\n      \"linear-gradient(0deg, rgba(20,71,207,1) 7%, rgba(49,119,254,1) 100%)\",\n    border: \"none\",\n    borderRadius: \"5px\",\n    padding: \".3rem .5rem\",\n    minWidth: \"4rem\",\n    margin: \"1rem auto\"\n  },\n  footerRows: {\n    width: \"100%\"\n  },\n  totals: {\n    color: \"#21942a\",\n    fontWeight: \"800\"\n  }\n});\n\nfunction createData(\n  date,\n  month,\n  teachingMins,\n  outsideDutyMins,\n  holidayMins,\n  travelAllowance,\n  travelExpenses\n) {\n  return {\n    date,\n    month,\n    teachingMins,\n    outsideDutyMins,\n    holidayMins,\n    travelAllowance,\n    travelExpenses\n  };\n}\n\nconst Payroll = props => {\n  const componentRef = useRef();\n  const classes = useStyles();\n\n  const { teachers } = useContext(TeachersContext);\n  const [stage, setStage] = useState(\"teacherSelect\");\n  const [rows, setRows] = useState([]);\n  const [currentTeacher, setCurrentTeacher] = useState(\"\");\n  const { events, setFormType } = props;\n  const now = new Date();\n  const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n  const monthEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n  const daysInMonth = moment(now).daysInMonth();\n\n  const showPayrollSheet = teacher => {\n    setCurrentTeacher(teacher.resourceId);\n\n    const teachingMinsByDate = createPayPeriodData(\n      events,\n      teacher,\n      monthStart,\n      monthEnd\n    );\n\n    const rows = [];\n    for (let i = 1; i <= daysInMonth; i++) {\n      let newRow;\n      if (teachingMinsByDate[i]) {\n        newRow = createData(\n          i,\n          now.getMonth(\"MMM\"),\n          teachingMinsByDate[i].teachingMins,\n          teachingMinsByDate[i].outsideDutyMins,\n          teachingMinsByDate[i].holidayMins,\n          teachingMinsByDate[i].travelAllowance,\n          teachingMinsByDate[i].travelExpenses\n        );\n      } else {\n        newRow = createData(i, now.getMonth(\"MMM\"), 0, 0, 0, 0, 0);\n      }\n      rows.push(newRow);\n    }\n    setRows(rows);\n    setStage(\"payrollSheet\");\n  };\n\n  const hideForm = () => {\n    setStage(\"\");\n    setFormType(\"\");\n  };\n\n  return (\n    <div>\n      <Dialog\n        onClose={hideForm}\n        aria-labelledby=\"teacher-select-title\"\n        open={stage === \"teacherSelect\"}\n      >\n        <DialogTitle id=\"teacher-select-title\">\n          Payroll: Select a teacher\n        </DialogTitle>\n        <List>\n          {teachers.map(t => (\n            <ListItem\n              button\n              onClick={() => showPayrollSheet(t)}\n              key={t.resourceId}\n            >\n              <ListItemAvatar>\n                <Avatar className={classes.avatar}>\n                  <PersonIcon />\n                </Avatar>\n              </ListItemAvatar>\n              <ListItemText primary={t.name} />\n            </ListItem>\n          ))}\n        </List>\n      </Dialog>\n      <Dialog\n        onClose={hideForm}\n        aria-labelledby=\"payroll-sheet-dialog\"\n        open={stage === \"payrollSheet\"}\n      >\n        <PayrollSheet\n          classes={classes}\n          rows={rows}\n          currentTeacher={currentTeacher}\n          ref={componentRef}\n        />\n        <ReactToPrint\n          trigger={() => <button className={classes.btn}>Print</button>}\n          content={() => componentRef.current}\n        />\n      </Dialog>\n    </div>\n  );\n};\nexport default Payroll;\n"]},"metadata":{},"sourceType":"module"}